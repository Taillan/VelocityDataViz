{"ast":null,"code":"'use strict';\n\nconst EventEmitter = require('events');\nconst Errors = require('../misc/errors');\n\n/**\n * Default command interface.\n */\nclass Command extends EventEmitter {\n  constructor(cmdParam, resolve, reject) {\n    super();\n    this.cmdParam = cmdParam;\n    this.sequenceNo = -1;\n    this.compressSequenceNo = -1;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.sending = false;\n    this.unexpectedError = this.throwUnexpectedError.bind(this);\n  }\n  displaySql() {\n    return null;\n  }\n\n  /**\n   * Throw an unexpected error.\n   * server exchange will still be read to keep connection in a good state, but promise will be rejected.\n   *\n   * @param msg message\n   * @param fatal is error fatal for connection\n   * @param info current server state information\n   * @param sqlState error sqlState\n   * @param errno error number\n   */\n  throwUnexpectedError(msg, fatal, info, sqlState, errno) {\n    const err = Errors.createError(msg, errno, info, sqlState, this.displaySql(), fatal, this.cmdParam ? this.cmdParam.stack : null, false);\n    if (this.reject) {\n      process.nextTick(this.reject, err);\n      this.resolve = null;\n      this.reject = null;\n    }\n    return err;\n  }\n\n  /**\n   * Create and throw new Error from error information\n   * only first called throwing an error or successfully end will be executed.\n   *\n   * @param msg message\n   * @param fatal is error fatal for connection\n   * @param info current server state information\n   * @param sqlState error sqlState\n   * @param errno error number\n   */\n  throwNewError(msg, fatal, info, sqlState, errno) {\n    this.onPacketReceive = null;\n    const err = this.throwUnexpectedError(msg, fatal, info, sqlState, errno);\n    this.emit('end');\n    return err;\n  }\n\n  /**\n   * Throw Error\n   *  only first called throwing an error or successfully end will be executed.\n   *\n   * @param err error to be thrown\n   * @param info current server state information\n   */\n  throwError(err, info) {\n    this.onPacketReceive = null;\n    if (this.reject) {\n      if (this.cmdParam && this.cmdParam.stack) {\n        err = Errors.createError(err.text ? err.text : err.message, err.errno, info, err.sqlState, err.sql, err.fatal, this.cmdParam.stack, false);\n      }\n      this.resolve = null;\n      process.nextTick(this.reject, err);\n      this.reject = null;\n    }\n    this.emit('end', err);\n  }\n\n  /**\n   * Successfully end command.\n   * only first called throwing an error or successfully end will be executed.\n   *\n   * @param val return value.\n   */\n  successEnd(val) {\n    this.onPacketReceive = null;\n    if (this.resolve) {\n      this.reject = null;\n      process.nextTick(this.resolve, val);\n      this.resolve = null;\n    }\n    this.emit('end');\n  }\n}\nmodule.exports = Command;","map":{"version":3,"names":["EventEmitter","require","Errors","Command","constructor","cmdParam","resolve","reject","sequenceNo","compressSequenceNo","sending","unexpectedError","throwUnexpectedError","bind","displaySql","msg","fatal","info","sqlState","errno","err","createError","stack","process","nextTick","throwNewError","onPacketReceive","emit","throwError","text","message","sql","successEnd","val","module","exports"],"sources":["/home/warameur/Documents/velocity-data-viz/node_modules/mariadb/lib/cmd/command.js"],"sourcesContent":["'use strict';\n\nconst EventEmitter = require('events');\nconst Errors = require('../misc/errors');\n\n/**\n * Default command interface.\n */\nclass Command extends EventEmitter {\n  constructor(cmdParam, resolve, reject) {\n    super();\n    this.cmdParam = cmdParam;\n    this.sequenceNo = -1;\n    this.compressSequenceNo = -1;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.sending = false;\n    this.unexpectedError = this.throwUnexpectedError.bind(this);\n  }\n\n  displaySql() {\n    return null;\n  }\n\n  /**\n   * Throw an unexpected error.\n   * server exchange will still be read to keep connection in a good state, but promise will be rejected.\n   *\n   * @param msg message\n   * @param fatal is error fatal for connection\n   * @param info current server state information\n   * @param sqlState error sqlState\n   * @param errno error number\n   */\n  throwUnexpectedError(msg, fatal, info, sqlState, errno) {\n    const err = Errors.createError(\n      msg,\n      errno,\n      info,\n      sqlState,\n      this.displaySql(),\n      fatal,\n      this.cmdParam ? this.cmdParam.stack : null,\n      false\n    );\n    if (this.reject) {\n      process.nextTick(this.reject, err);\n      this.resolve = null;\n      this.reject = null;\n    }\n    return err;\n  }\n\n  /**\n   * Create and throw new Error from error information\n   * only first called throwing an error or successfully end will be executed.\n   *\n   * @param msg message\n   * @param fatal is error fatal for connection\n   * @param info current server state information\n   * @param sqlState error sqlState\n   * @param errno error number\n   */\n  throwNewError(msg, fatal, info, sqlState, errno) {\n    this.onPacketReceive = null;\n    const err = this.throwUnexpectedError(msg, fatal, info, sqlState, errno);\n    this.emit('end');\n    return err;\n  }\n\n  /**\n   * Throw Error\n   *  only first called throwing an error or successfully end will be executed.\n   *\n   * @param err error to be thrown\n   * @param info current server state information\n   */\n  throwError(err, info) {\n    this.onPacketReceive = null;\n    if (this.reject) {\n      if (this.cmdParam && this.cmdParam.stack) {\n        err = Errors.createError(\n          err.text ? err.text : err.message,\n          err.errno,\n          info,\n          err.sqlState,\n          err.sql,\n          err.fatal,\n          this.cmdParam.stack,\n          false\n        );\n      }\n      this.resolve = null;\n      process.nextTick(this.reject, err);\n      this.reject = null;\n    }\n    this.emit('end', err);\n  }\n\n  /**\n   * Successfully end command.\n   * only first called throwing an error or successfully end will be executed.\n   *\n   * @param val return value.\n   */\n  successEnd(val) {\n    this.onPacketReceive = null;\n    if (this.resolve) {\n      this.reject = null;\n      process.nextTick(this.resolve, val);\n      this.resolve = null;\n    }\n    this.emit('end');\n  }\n}\n\nmodule.exports = Command;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}